<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø§Ø³ØªØ±Ø¯Ø§Ø¯ Ø§Ù„ÙŠÙˆÙ…ÙŠ</title>
<style>
  body {
    font-family: "Tahoma", Arial, sans-serif;
    background-color: #f4f7f8;
    padding: 20px;
    text-align: center;
  }

  h1 {
    color: #004d4d;
    margin-bottom: 25px;
  }

  .form-container {
    background: white;
    border-radius: 16px;
    box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    max-width: 400px;
    margin: 0 auto 25px;
    padding: 25px;
    text-align: right;
  }

  label {
    display: block;
    font-weight: bold;
    margin: 10px 0 5px;
    color: #005f5f;
  }

  input {
    width: 100%;
    padding: 10px;
    border: 2px solid #009688;
    border-radius: 8px;
    font-size: 15px;
    text-align: center;
    transition: 0.3s;
  }

  input:focus {
    background-color: #e0f7f6;
    border-color: #006b6b;
    outline: none;
  }

  .button-group {
    margin-top: 15px;
    display: flex;
    justify-content: space-between;
    gap: 10px;
  }

  button {
    flex: 1;
    background-color: #009688;
    color: white;
    border: none;
    padding: 10px 16px;
    border-radius: 8px;
    cursor: pointer;
    font-size: 15px;
    transition: 0.3s;
  }

  button:hover {
    background-color: #00796b;
  }

  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 25px;
    border: 2px solid #ccc;
    background-color: white;
    border-radius: 10px;
    overflow: hidden;
  }

  th, td {
    border: 1px solid #ddd;
    padding: 10px;
    text-align: center;
    font-size: 15px;
  }

  th {
    background-color: #009688;
    color: white;
  }

  tr:nth-child(even) td {
    background-color: #f9f9f9;
  }

  .refund-result {
    margin-top: 25px;
    font-size: 20px;
    font-weight: bold;
    color: #006b6b;
    background-color: #e0f7f6;
    border: 2px dashed #009688;
    display: inline-block;
    padding: 15px 25px;
    border-radius: 10px;
    display: none;
  }

  .signature {
    margin-top: 40px;
    text-align: left;
    font-weight: bold;
    font-size: 17px;
    color: #007b83;
  }

  .signature::after {
    content: " ___________________";
    color: #007b83;
  }
</style>
</head>
<body>

<h1>ğŸ“Š Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø§Ø³ØªØ±Ø¯Ø§Ø¯ Ø§Ù„ÙŠÙˆÙ…ÙŠ</h1>

<div class="form-container">
  <label>Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„</label>
  <input type="text" id="clientName" placeholder="Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„">

  <label>Ø±Ù‚Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„</label>
  <input type="text" id="clientNumber" placeholder="Ø§ÙƒØªØ¨ Ø±Ù‚Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„">

  <label>Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¨Ø§Ù‚Ø© Ø§Ù„Ù…Ø´ØªØ±Ùƒ Ø¹Ù„ÙŠÙ‡Ø§</label>
  <input type="number" id="packageValue" placeholder="Ø£Ø¯Ø®Ù„ Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¨Ø§Ù‚Ø©">

  <label>Ø¹Ø¯Ø¯ Ø£ÙŠØ§Ù… Ø§Ù„Ø¨Ø§Ù‚Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©</label>
  <input type="number" id="totalDays" placeholder="Ù…Ø«Ù„Ø§Ù‹ 30">

  <label>Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ù…Ø³ØªÙØ§Ø¯ Ø¨Ù‡Ø§</label>
  <input type="number" id="daysUsed" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ù…Ø³ØªÙØ§Ø¯ Ø¨Ù‡Ø§">

  <label>Ø§Ø³Ù… Ø§Ù„Ø¨Ù†Ùƒ</label>
  <input type="text" id="bankName" placeholder="Ø§Ø³Ù… Ø§Ù„Ø¨Ù†Ùƒ">

  <label>Ø±Ù‚Ù… Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¨Ù†ÙƒÙŠ</label>
  <input type="text" id="bankAccount" placeholder="Ø±Ù‚Ù… Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¨Ù†ÙƒÙŠ">

  <label>Ù†ÙˆØ¹ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ</label>
  <input type="text" id="subscriptionType" placeholder="Ù†ÙˆØ¹ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ">

  <label>Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª</label>
  <input type="text" id="notes" placeholder="Ø§ÙƒØªØ¨ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ù† ÙˆØ¬Ø¯Øª">

  <div class="button-group">
    <button onclick="calculateRefund()">ğŸ’° Ø§Ø­Ø³Ø¨ Ø§Ù„Ø§Ø³ØªØ±Ø¯Ø§Ø¯</button>
    <button onclick="addClient()">â• Ø¥Ø¶Ø§ÙØ© Ø¹Ù…ÙŠÙ„</button>
  </div>
</div>

<table id="clientsTable">
  <tr>
    <th>Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„</th>
    <th>Ø±Ù‚Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„</th>
    <th>Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¨Ø§Ù‚Ø©</th>
    <th>Ø£ÙŠØ§Ù… Ø§Ù„Ø¨Ø§Ù‚Ø©</th>
    <th>Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ù…Ø³ØªÙØ§Ø¯ Ø¨Ù‡Ø§</th>
    <th>Ø§Ø³Ù… Ø§Ù„Ø¨Ù†Ùƒ</th>
    <th>Ø±Ù‚Ù… Ø§Ù„Ø­Ø³Ø§Ø¨</th>
    <th>Ù†ÙˆØ¹ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ</th>
    <th>Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø³ØªØ±Ø¯</th>
    <th>Ù…Ù„Ø§Ø­Ø¸Ø§Øª</th>
    <th>âŒ</th>
  </tr>
</table>

<div id="refundResult" class="refund-result"></div>

<button onclick="exportToExcel()">ğŸ“¥ Ø¥ØµØ¯Ø§Ø± Ù…Ù„Ù Excel</button>

<div class="signature">Accountant Mousa</div>

<script>
let clients = [];
let lastRefund = 0;

// Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø³ØªØ±Ø¯
function calculateRefund() {
  const packageValue = parseFloat(document.getElementById('packageValue').value);
  const totalDays = parseFloat(document.getElementById('totalDays').value);
  const daysUsed = parseFloat(document.getElementById('daysUsed').value);

  if (!isNaN(packageValue) && !isNaN(daysUsed) && !isNaN(totalDays) && daysUsed <= totalDays) {
    const refund = ((totalDays - daysUsed) / totalDays) * packageValue;
    lastRefund = refund.toFixed(2);

    const resultDiv = document.getElementById('refundResult');
    resultDiv.style.display = 'inline-block';
    resultDiv.innerHTML = `ğŸ’µ Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø³ØªØ±Ø¯: <span style="color:#004d4d;">${lastRefund} Ø±ÙŠØ§Ù„</span>`;
  } else {
    alert("ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¨Ø§Ù‚Ø© ÙˆØ¹Ø¯Ø¯ Ø§Ù„Ø£ÙŠØ§Ù… Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­.");
  }
}

function addClient() {
  const client = {
    name: document.getElementById('clientName').value.trim(),
    number: document.getElementById('clientNumber').value.trim(),
    package: document.getElementById('packageValue').value.trim(),
    total: document.getElementById('totalDays').value.trim(),
    days: document.getElementById('daysUsed').value.trim(),
    bank: document.getElementById('bankName').value.trim(),
    account: document.getElementById('bankAccount').value.trim(),
    type: document.getElementById('subscriptionType').value.trim(),
    refund: lastRefund,
    notes: document.getElementById('notes').value.trim()
  };

  if (!client.name || !client.number) return alert("Ø£Ø¯Ø®Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©.");

  clients.push(client);
  renderTable();
  clearInputs();
  document.getElementById('refundResult').style.display = 'none';
}

function removeClient(index) {
  clients.splice(index, 1);
  renderTable();
}

function renderTable() {
  const table = document.getElementById("clientsTable");
  table.innerHTML = `
    <tr>
      <th>Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„</th>
      <th>Ø±Ù‚Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„</th>
      <th>Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¨Ø§Ù‚Ø©</th>
      <th>Ø£ÙŠØ§Ù… Ø§Ù„Ø¨Ø§Ù‚Ø©</th>
      <th>Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ù…Ø³ØªÙØ§Ø¯ Ø¨Ù‡Ø§</th>
      <th>Ø§Ø³Ù… Ø§Ù„Ø¨Ù†Ùƒ</th>
      <th>Ø±Ù‚Ù… Ø§Ù„Ø­Ø³Ø§Ø¨</th>
      <th>Ù†ÙˆØ¹ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ</th>
      <th>Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø³ØªØ±Ø¯</th>
      <th>Ù…Ù„Ø§Ø­Ø¸Ø§Øª</th>
      <th>âŒ</th>
    </tr>
  `;

  clients.forEach((c, i) => {
    const row = `
      <tr>
        <td>${c.name}</td>
        <td>${c.number}</td>
        <td>${c.package}</td>
        <td>${c.total}</td>
        <td>${c.days}</td>
        <td>${c.bank}</td>
        <td>${c.account}</td>
        <td>${c.type}</td>
        <td style="color:#004d4d; font-weight:bold;">${c.refund}</td>
        <td>${c.notes}</td>
        <td><button onclick="removeClient(${i})" style="background:red; color:white; border:none; border-radius:5px; padding:3px 8px; cursor:pointer;">X</button></td>
      </tr>`;
    table.innerHTML += row;
  });
}

function clearInputs() {
  document.querySelectorAll('input').forEach(i => i.value = '');
  lastRefund = 0;
}

function exportToExcel() {
  let html = `
    <table border='1' style='border-collapse:collapse; font-family:Tahoma; font-size:14px;'>
      <tr>
        <th style='background-color:#009688; color:white;'>Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„</th>
        <th style='background-color:#009688; color:white;'>Ø±Ù‚Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„</th>
        <th style='background-color:#009688; color:white;'>Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¨Ø§Ù‚Ø©</th>
        <th style='background-color:#009688; color:white;'>Ø£ÙŠØ§Ù… Ø§Ù„Ø¨Ø§Ù‚Ø©</th>
        <th style='background-color:#009688; color:white;'>Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ù…Ø³ØªÙØ§Ø¯ Ø¨Ù‡Ø§</th>
        <th style='background-color:#009688; color:white;'>Ø§Ø³Ù… Ø§Ù„Ø¨Ù†Ùƒ</th>
        <th style='background-color:#009688; color:white;'>Ø±Ù‚Ù… Ø§Ù„Ø­Ø³Ø§Ø¨</th>
        <th style='background-color:#009688; color:white;'>Ù†ÙˆØ¹ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ</th>
        <th style='background-color:#009688; color:white;'>Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø³ØªØ±Ø¯</th>
        <th style='background-color:#009688; color:white;'>Ù…Ù„Ø§Ø­Ø¸Ø§Øª</th>
      </tr>
  `;

  clients.forEach(c => {
    html += `
      <tr>
        <td>${c.name}</td>
        <td>${c.number}</td>
        <td>${c.package}</td>
        <td>${c.total}</td>
        <td>${c.days}</td>
        <td>${c.bank}</td>
        <td>${c.account}</td>
        <td>${c.type}</td>
        <td>${c.refund}</td>
        <td>${c.notes}</td>
      </tr>`;
  });

  html += `
      <tr><td colspan='10' style='text-align:left; font-weight:bold; color:#007b83;'>Accountant Mousa ________</td></tr>
    </table>
  `;

  const blob = new Blob([html], { type: "application/vnd.ms-excel" });
  const url = URL.createObjectURL(blob);
  const link = document.createElement("a");
  link.href = url;
  const today = new Date();
  const dateStr = today.toLocaleDateString("ar-SA", { day: "2-digit", month: "long" });
  link.download = `Ù…Ù„Ù Ø§Ù„Ø§Ø³ØªØ±Ø¯Ø§Ø¯ Ø§Ù„ÙŠÙˆÙ…ÙŠ ${dateStr}.xls`;
  link.click();
}
</script>

</body>
</html>
