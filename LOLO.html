<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ุญุงุณุจุฉ ุงูุงุณุชุฑุฏุงุฏ ุงููููู</title>
<style>
/* ======================== ุฅุนุฏุงุฏุงุช ุงูุตูุญุฉ ======================== */
body {
  font-family: "Tahoma", Arial, sans-serif; /* ุฎุท ุงูุตูุญุฉ */
  background: #e0f7fa; /* ุฎูููุฉ ุณูุงูู ูุงุชุญ ูุฑูุญ ููุนูู */
  margin: 0; 
  padding: 20px;
  display: flex;
  flex-direction: column;
  align-items: center; /* ูู ุดูุก ูู ูุณุท ุงูุตูุญุฉ */
}

/* ======================== ุนููุงู ุงูุตูุญุฉ ======================== */
h1 {
  color: #03a9f4; /* ููู ุนููุงู ุจุฑูุงู ุณูุงูู */
  text-align: center;
  margin-bottom: 25px;
}

/* ======================== ุตูุฏูู ุงูุฅุฏุฎุงู ======================== */
.form-container {
  background: #ffffff; /* ุฎูููุฉ ุจูุถุงุก ูุตูุฏูู ุงูุฅุฏุฎุงู */
  border-radius: 12px; /* ุญูุงู ุฏุงุฆุฑูุฉ */
  box-shadow: 0 4px 10px rgba(0,0,0,0.1); /* ุธู ุฎููู ุญูู ุงูุตูุฏูู */
  width: 100%; /* ุนุฑุถ ูุณุจู */
  max-width: 350px; /* ุฃูุตู ุนุฑุถ ููุตูุฏูู */
  padding: 20px;
  display: flex;
  flex-direction: column; /* ุชุฑุชูุจ ุงูุญููู ุนููุฏู */
  gap: 12px; /* ูุณุงูุฉ ุจูู ุงูุญููู */
}

/* ======================== ุชุณููุงุช ุงูุญููู ======================== */
label {
  font-weight: bold; /* ุฎุท ุบุงูู */
  color: #00796b; /* ุฃุฎุถุฑ ุฏุงูู */
  font-size: 14px;
}

/* ======================== ุญููู ุงูุฅุฏุฎุงู ======================== */
input, select {
  width: 100%; /* ุงูุญูู ูููุฃ ุนุฑุถ ุงูุตูุฏูู */
  padding: 8px; /* ูุณุงุญุฉ ุฏุงุฎู ุงูุญูู */
  border: 2px solid #03a9f4; /* ุฅุทุงุฑ ุณูุงูู */
  border-radius: 6px;
  font-size: 14px;
  text-align: center; /* ูุชุงุจุฉ ุงููุต ูู ูุณุท ุงูุญูู */
  transition: 0.3s; /* ุชุฃุซูุฑ ุณูุณ ุนูุฏ ุงูุชุฑููุฒ */
}

input:focus, select:focus {
  background-color: #e1f5fe; /* ููู ูุงุชุญ ุนูุฏ ุงูุชุฑููุฒ */
  border-color: #0288d1; /* ุชุบููุฑ ููู ุงูุฅุทุงุฑ ุนูุฏ ุงูุชุฑููุฒ */
  outline: none;
}

/* ======================== ุฃุฒุฑุงุฑ ======================== */
button {
  background-color: #03a9f4; /* ููู ุฃุฒุฑู ุณูุงูู ููุฒุฑ */
  color: white; /* ููู ุงููุชุงุจุฉ ุฃุจูุถ */
  border: none;
  padding: 10px;
  border-radius: 6px;
  cursor: pointer;
  font-size: 14px;
  transition: 0.3s;
}

button:hover {
  background-color: #0288d1; /* ููู ุงูุฒุฑ ุนูุฏ ุงููุฑูุฑ ุนููู */
}

button.calculate {
  background-color: #00bcd4; /* ุฒุฑ "ุงุญุณุจ ุงูุงุณุชุฑุฏุงุฏ" ุจููู ุฃุฒุฑู ุณูุงูู ูุฎุชูู */
}

/* ======================== ุฌุฏูู ุงูุนููุงุก ======================== */
table {
  width: 100%; /* ุนุฑุถ ูุณุจู */
  max-width: 320px; /* ุฃูุตู ุนุฑุถ ููุฌุฏูู */
  border-collapse: collapse; /* ุฅุฒุงูุฉ ุงููุณุงูุงุช ุจูู ุงูุญุฏูุฏ */
  margin-top: 20px;
  text-align: center;
}

th, td {
  border: 1px solid #03a9f4; /* ุญุฏูุฏ ุณูุงูู */
  padding: 6px; /* ูุณุงุญุฉ ุตุบูุฑุฉ ุฏุงุฎู ุงูุฎููุฉ */
  font-size: 13px; /* ุญุฌู ุตุบูุฑ ูุชูููู ุงููุณุงุญุฉ */
}

th {
  background-color: #03a9f4; /* ููู ุงูุนููุงู */
  color: white; /* ูุต ุงูุนููุงู ุฃุจูุถ */
}

/* ุตููู ูุชุจุงุฏูุฉ ุจููู ูุงุชุญ */
tr:nth-child(even) td {
  background-color: #e1f5fe; /* ููู ุณูุงูู ูุงุชุญ ููุตููู ุงูุฒูุฌูุฉ */
}

/* ======================== ุฑุณุงูุฉ ูุฌุงุญ ======================== */
.success-message {
  color: green; /* ุงูููู ุงูุฃุฎุถุฑ */
  font-weight: bold; /* ุฎุท ุบุงูู */
  margin-bottom: 5px;
  display: none; /* ูุฎููุฉ ุจุดูู ุงูุชุฑุงุถู */
  text-align: center;
  font-size: 14px;
}
.success-message::before {
  content: "โ "; /* ุนูุงูุฉ ุตุญ ูุจู ุงูุฑุณุงูุฉ */
}

/* ======================== ูุชุฌุงูุจ ูุน ุฃู ุดุงุดุฉ ======================== */
@media screen and (max-width: 768px) {
  body {
    padding: 10px; /* ุชูููู ุงูุญูุงู ููุดุงุดุงุช ุงูุตุบูุฑุฉ */
  }

  .form-container {
    width: 100%; /* ูุบุทู ุนุฑุถ ุงูุฌูุงู ุจุงููุงูู */
    max-width: none; /* ุฅุฒุงูุฉ ุงูุญุฏ ุงูุฃูุตู */
    padding: 15px; 
  }

  input, select, button {
    font-size: 13px; /* ุชุตุบูุฑ ุญุฌู ุงูุฎุท */
    padding: 6px; /* ุชูููู ุงููุณุงุญุฉ ุฏุงุฎู ุงูุญููู */
  }

  table {
    width: 100%; /* ุงูุฌุฏูู ูุบุทู ุนุฑุถ ุงูุฌูุงู ุจุงููุงูู */
    max-width: none; /* ุฅุฒุงูุฉ ุงูุญุฏ ุงูุฃูุตู */
    font-size: 12px; /* ุชุตุบูุฑ ุงูุฎุท */
  }

  th, td {
    padding: 5px; /* ุชูููู ูุณุงุญุฉ ุงูุฎููุฉ */
  }
}
</style>
</head>
<body>

<h1>ุญุงุณุจุฉ ุงูุงุณุชุฑุฏุงุฏ ุงููููู</h1>

<!-- ======================== ุตูุฏูู ุงูุฅุฏุฎุงู ======================== -->
<div class="form-container">
  <div class="success-message" id="successMsg">ุชู ุญูุธ ุงูุนููู ุจูุฌุงุญ</div>

  <label>ุงุณู ุงูุนููู</label>
  <input type="text" id="clientName" placeholder="ุงุฏุฎู ุงุณู ุงูุนููู">

  <label>ุฑูู ุงูุนููู</label>
  <input type="text" id="clientNumber" placeholder="ุงุฏุฎู ุฑูู ุงูุนููู">

  <label>ูููุฉ ุงูุจุงูุฉ</label>
  <input type="number" id="packageValue" placeholder="ุงุฏุฎู ูููุฉ ุงูุจุงูุฉ">

  <label>ุนุฏุฏ ุฃูุงู ุงูุจุงูุฉ ุงูุฃุณุงุณูุฉ</label>
  <input type="number" id="packageDays" placeholder="ุงุฏุฎู ุนุฏุฏ ุฃูุงู ุงูุจุงูุฉ">

  <label>ุนุฏุฏ ุงูุฃูุงู ุงููุณุชูุงุฏ ุจูุง</label>
  <input type="number" id="daysUsed" placeholder="ุงุฏุฎู ุนุฏุฏ ุงูุฃูุงู ุงููุณุชูุงุฏ ุจูุง">

  <label>ุงุณู ุงูุจูู</label>
  <input type="text" id="bankName" placeholder="ุงุฏุฎู ุงุณู ุงูุจูู">

  <label>ุฑูู ุงูุญุณุงุจ ุงูุจููู</label>
  <input type="text" id="bankAccount" placeholder="ุงุฏุฎู ุฑูู ุงูุญุณุงุจ">

  <label>ููุน ุงูุงุดุชุฑุงู</label>
  <select id="subscriptionType">
    <option value="ุฌุฏูุฏ ุชุทุจูู">ุฌุฏูุฏ ุชุทุจูู</option>
    <option value="ุชุฌุฏูุฏ ุชุทุจูู">ุชุฌุฏูุฏ ุชุทุจูู</option>
    <option value="ุฌุฏูุฏ ูุฏูู">ุฌุฏูุฏ ูุฏูู</option>
    <option value="ุชุฌุฏูุฏ ูุฏูู">ุชุฌุฏูุฏ ูุฏูู</option>
  </select>

  <label>ุงูููุงุญุธุงุช</label>
  <input type="text" id="notes" placeholder="ุงุฏุฎู ููุงุญุธุงุช">

  <button onclick="addClient()">๐พ ุญูุธ ุงูุนููู</button> <!-- ุฒุฑ ูุญูุธ ุจูุงูุงุช ุงูุนููู -->
  <button class="calculate" onclick="calculateRefund()">ุงุญุณุจ ุงูุงุณุชุฑุฏุงุฏ</button> <!-- ุฒุฑ ูุญุณุงุจ ุงูุงุณุชุฑุฏุงุฏ -->
</div>

<!-- ======================== ุฌุฏูู ุงูุนููุงุก ุงููุตุบูุฑ ======================== -->
<table id="clientsTable">
  <tr>
    <th>ุงุณู ุงูุนููู</th> <!-- ุนููุงู ุนููุฏ ุงุณู ุงูุนููู -->
    <th>ูููุฉ ุงูุจุงูุฉ(ุนุฏุฏ ุงูุฃูุงู)</th> <!-- ุนููุงู ุนููุฏ ุณุนุฑ ุงูุจุงูุฉ ูุนุฏุฏ ุงูุฃูุงู -->
    <th>ุงููุจูุบ ุงููุณุชุฑุฏ</th> <!-- ุนููุงู ุนููุฏ ุงูุงุณุชุฑุฏุงุฏ -->
  </tr>
</table>

<!-- ุฒุฑ ุชุตุฏูุฑ ุงูููู -->
<button onclick="exportToExcel()">๐ฅ ุฅุตุฏุงุฑ ููู Excel</button>

<script>
// ======================= ูุตูููุฉ ูุชุฎุฒูู ุจูุงูุงุช ุงูุนููุงุก =======================
let clients = [];

// ======================= ุฅุถุงูุฉ ุนููู =======================
function addClient() {
  const name = document.getElementById('clientName').value.trim(); // ุงุณู ุงูุนููู
  const number = document.getElementById('clientNumber').value.trim(); // ุฑูู ุงูุนููู
  const packageValue = document.getElementById('packageValue').value.trim(); // ุณุนุฑ ุงูุจุงูุฉ
  const packageDays = document.getElementById('packageDays').value.trim(); // ุนุฏุฏ ุฃูุงู ุงูุจุงูุฉ
  const daysUsed = document.getElementById('daysUsed').value.trim(); // ุงูุฃูุงู ุงููุณุชูุงุฏ ุจูุง
  const bank = document.getElementById('bankName').value.trim();
  const account = document.getElementById('bankAccount').value.trim();
  const type = document.getElementById('subscriptionType').value;
  const notes = document.getElementById('notes').value.trim();

  // ุชุญูู ูู ุงูุจูุงูุงุช ุงูุฃุณุงุณูุฉ
  if(!name || !number) {
    alert("ุฃุฏุฎู ุงูุจูุงูุงุช ุงูุฃุณุงุณูุฉ ููุนููู");
    return;
  }
  if(daysUsed > packageDays) {
    alert("ุนุฏุฏ ุงูุฃูุงู ุงููุณุชูุงุฏ ุจูุง ูุง ูููู ุฃู ูุชุฌุงูุฒ ุฃูุงู ุงูุจุงูุฉ ุงูุฃุณุงุณูุฉ");
    return;
  }

  // ุฅุถุงูุฉ ุงูุนููู ุฅูู ุงููุตูููุฉ
  clients.push({name, number, packageValue, packageDays, daysUsed, bank, account, type, refund:'', notes});

  // ุนุฑุถ ุฑุณุงูุฉ ูุฌุงุญ ูุตูุฑุฉ
  document.getElementById('successMsg').style.display = 'block';
  setTimeout(()=>document.getElementById('successMsg').style.display='none',2000);

  renderTable(); // ุชุญุฏูุซ ุงูุฌุฏูู ุงูุตุบูุฑ ุฃุณูู ุงูุตูุญุฉ
}

// ======================= ุญุณุงุจ ุงูุงุณุชุฑุฏุงุฏ =======================
function calculateRefund() {
  clients.forEach(c => {
    // ุญุณุงุจ ุงููุจูุบ ุงููุณุชุฑุฏ: ุณุนุฑ ุงูุจุงูุฉ / ุฃูุงู ุงูุจุงูุฉ * ุงูุฃูุงู ุงููุณุชูุงุฏ ุจูุง
    c.refund = ((c.packageValue / c.packageDays) * c.daysUsed).toFixed(2);
  });
  renderTable(); // ุชุญุฏูุซ ุงูุฌุฏูู ุจุนุฏ ุงูุญุณุงุจ
}

// ======================= ุนุฑุถ ุงูุฌุฏูู ุงูุตุบูุฑ =======================
function renderTable() {
  const table = document.getElementById("clientsTable");
  table.innerHTML = `
    <tr>
      <th>ุงุณู ุงูุนููู</th>
      <th>ูููุฉ ุงูุจุงูุฉ(ุนุฏุฏ ุงูุฃูุงู)</th>
      <th>ุงููุจูุบ ุงููุณุชุฑุฏ</th>
    </tr>
  `;
  clients.forEach(c => {
    table.innerHTML += `<tr>
      <td>${c.name}</td>
      <td>${c.packageValue}(${c.packageDays})</td>
      <td>${c.refund}</td>
    </tr>`;
  });
}

// ======================= ุชุตุฏูุฑ Excel =======================
function exportToExcel() {
  let html = `<table border='1' style='border-collapse:collapse; font-family:Tahoma; font-size:14px;'>`;
  html += `<tr>
    <th>ุงุณู ุงูุนููู</th>
    <th>ุฑูู ุงูุนููู</th>
    <th>ูููุฉ ุงูุจุงูุฉ(ุนุฏุฏ ุงูุฃูุงู)</th>
    <th>ุนุฏุฏ ุงูุฃูุงู ุงููุณุชูุงุฏ ุจูุง</th>
    <th>ุงุณู ุงูุจูู</th>
    <th>ุฑูู ุงูุญุณุงุจ ุงูุจููู</th>
    <th>ููุน ุงูุงุดุชุฑุงู</th>
    <th>ุงููุจูุบ ุงููุณุชุฑุฏ</th>
    <th>ุงูููุงุญุธุงุช</th>
  </tr>`;
  clients.forEach(c => {
    html += `<tr>
      <td>${c.name}</td>
      <td>${c.number}</td>
      <td>${c.packageValue}(${c.packageDays})</td>
      <td>${c.daysUsed}</td>
      <td>${c.bank}</td>
      <td>${c.account}</td>
      <td>${c.type}</td>
      <td>${c.refund}</td>
      <td>${c.notes}</td>
    </tr>`;
  });
  html += "</table>";

  const blob = new Blob([html], { type: "application/vnd.ms-excel" });
  const url = URL.createObjectURL(blob);
  const link = document.createElement("a");

  const today = new Date();
  const yesterday = new Date(today);
  yesterday.setDate(today.getDate() - 1);
  const dateStr = yesterday.toLocaleDateString('en-GB', { day: '2-digit', month: 'long', year:'numeric' });

  link.href = url;
  link.download = `ุงูุงุณุชุฑุฏุงุฏ ุงููููู ${dateStr}.xls`;
  link.click();
}
</script>

</body>
</html>
