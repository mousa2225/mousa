<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8"> <!-- ุชุฑููุฒ ุงูุญุฑูู UTF-8 ูุฏุนู ุงูุนุฑุจูุฉ -->
<meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- ูุฌุนู ุงูุตูุญุฉ ูุชุฌุงูุจุฉ ูุน ุงูููุงุชู -->
<title>ุญุงุณุจุฉ ุงูุงุณุชุฑุฏุงุฏ ุงููููู</title> <!-- ุนููุงู ุงูุตูุญุฉ ูู ุงูุชุจููุจ -->

<style>
/* ======================== ุฅุนุฏุงุฏุงุช ุงูุตูุญุฉ ุงูุนุงูุฉ ======================== */
body {
  font-family: "Tahoma", Arial, sans-serif; /* ุงูุฎุท ุงูุงูุชุฑุงุถู ููุตูุญุฉ */
  background: linear-gradient(180deg, #e0f7fa 0%, #ffffff 100%); /* ุฎูููุฉ ูุชุฏุฑุฌุฉ ูู ุงูุฃุนูู ููุฃุณูู */
  margin: 0; /* ุฅุฒุงูุฉ ุงูููุงูุด ุงูุงูุชุฑุงุถูุฉ */
  padding: 20px; /* ูุณุงูุฉ ุฏุงุฎููุฉ ูู ุญูุงู ุงูุตูุญุฉ */
  display: flex; /* ุงุณุชุฎุฏุงู Flexbox ูุชุฑุชูุจ ุงูุนูุงุตุฑ */
  flex-direction: column; /* ุชุฑุชูุจ ุงูุนูุงุตุฑ ุนููุฏู */
  align-items: center; /* ูุญุงุฐุงุฉ ุงูุนูุงุตุฑ ุฃูููุงู ูููุณุท */
  min-height: 100vh; /* ุงุฑุชูุงุน ุงูุตูุญุฉ ุนูู ุงูุฃูู ูุณุงูู ุงุฑุชูุงุน ุงูุดุงุดุฉ */
  box-sizing: border-box; /* ุงุญุชุณุงุจ ุงูุญูุงู ุถูู ููุงุณ ุงูุนุฑุถ ูุงูุงุฑุชูุงุน */
}

/* ======================== ุงูุนููุงู ุงูุฑุฆูุณู ======================== */
h1 {
  color: #0288d1; /* ููู ุงููุต ุฃุฒุฑู */
  text-align: center; /* ุชูุณูุท ุงููุต */
  margin-bottom: 25px; /* ูุณุงูุฉ ุชุญุช ุงูุนููุงู */
  font-size: 24px; /* ุญุฌู ุงูุฎุท */
}

/* ======================== ุงูุญุงููุฉ ุงูุฑุฆูุณูุฉ ======================== */
.container {
  width: 100%; /* ุงูุนุฑุถ ูุงูู ุงูุญุงููุฉ */
  max-width: 480px; /* ุงูุญุฏ ุงูุฃูุตู ููุนุฑุถ */
  background: #fff; /* ุฎูููุฉ ุจูุถุงุก */
  border-radius: 14px; /* ุญูุงู ุฏุงุฆุฑูุฉ */
  box-shadow: 0 4px 15px rgba(0,0,0,0.1); /* ุธู ุฎููู */
  padding: 20px; /* ูุณุงูุฉ ุฏุงุฎููุฉ */
  box-sizing: border-box; /* ุชุถููู ุงูุญูุงู ุถูู ุงูููุงุณ */
}

/* ======================== ุงูุญููู ======================== */
label {
  font-weight: bold; /* ุฎุท ุนุฑูุถ */
  color: #00796b; /* ููู ุงููุต ุฃุฎุถุฑ ุบุงูู */
  font-size: 14px; /* ุญุฌู ุงูุฎุท */
  margin-top: 10px; /* ูุณุงูุฉ ุฃุนูู ูู label */
}

input, select {
  width: 100%; /* ุงูุญูู ูููุฃ ูุงูู ุงูุนุฑุถ */
  padding: 10px; /* ูุณุงูุฉ ุฏุงุฎููุฉ ุฏุงุฎู ุงูุญูู */
  margin-top: 5px; /* ูุณุงูุฉ ุจูู ุงูุญูู ูุงู label */
  border: 2px solid #03a9f4; /* ุญุฏูุฏ ุฒุฑูุงุก */
  border-radius: 6px; /* ุญูุงู ุฏุงุฆุฑูุฉ ุตุบูุฑุฉ */
  font-size: 14px; /* ุญุฌู ุงูุฎุท ุฏุงุฎู ุงูุญูู */
  text-align: center; /* ูุญุงุฐุงุฉ ุงููุต ูู ุงููุณุท */
  transition: 0.3s; /* ุชุฃุซูุฑ ุณูุณ ุนูุฏ ุงูุชุบููุฑ */
  box-sizing: border-box; /* ุงุญุชุณุงุจ ุงูุญูุงู ุถูู ุงูููุงุณ */
}

/* ุชุฃุซูุฑ ุนูุฏ ุงูุชุฑููุฒ ุฏุงุฎู ุงูุญูู */
input:focus, select:focus {
  border-color: #0288d1; /* ุชุบููุฑ ููู ุงูุญุฏูุฏ ุนูุฏ ุงูุชุฑููุฒ */
  background-color: #e1f5fe; /* ุชุบููุฑ ุฎูููุฉ ุงูุญูู */
  outline: none; /* ุฅุฒุงูุฉ ุงูุฅุทุงุฑ ุงูุงูุชุฑุงุถู */
}

/* ======================== ุงูุฃุฒุฑุงุฑ ======================== */
button {
  width: 100%; /* ุงูุฒุฑ ูุงูู ุนุฑุถ ุงูุญุงููุฉ */
  background-color: #03a9f4; /* ููู ุงูุฎูููุฉ ุฃุฒุฑู */
  color: white; /* ููู ุงููุต ุฃุจูุถ */
  border: none; /* ุฅุฒุงูุฉ ุงูุญุฏูุฏ */
  padding: 10px; /* ูุณุงูุฉ ุฏุงุฎููุฉ */
  border-radius: 6px; /* ุญูุงู ุฏุงุฆุฑูุฉ */
  cursor: pointer; /* ุดูู ุงููุคุดุฑ ูุฏ ุนูุฏ ุงููุฑูุฑ */
  font-size: 15px; /* ุญุฌู ุงูุฎุท */
  font-weight: bold; /* ุฎุท ุนุฑูุถ */
  margin-top: 10px; /* ูุณุงูุฉ ููู ุงูุฒุฑ */
  transition: 0.3s; /* ุชุฃุซูุฑ ุณูุณ ุนูุฏ ุงููุฑูุฑ */
}

/* ุชุบููุฑ ููู ุงูุฒุฑ ุนูุฏ ุงููุฑูุฑ ุนููู */
button:hover {
  background-color: #0288d1;
}

/* ุฒุฑ ุงูุญุณุงุจ ุจููู ูููุฒ */
button.calculate {
  background-color: #00bcd4;
}

/* ุฒุฑ ุงูุญุฐู ุจููู ุฃุญูุฑ */
button.delete {
  background-color: #f44336;
  font-size: 13px;
  padding: 6px 8px;
}

/* ======================== ุฑุณุงูุฉ ุงููุฌุงุญ ======================== */
.success-message {
  color: green; /* ููู ุงููุต ุฃุฎุถุฑ */
  font-weight: bold;
  text-align: center;
  display: none; /* ูุฎููุฉ ุงูุชุฑุงุถูุงู */
  margin-top: 10px;
  font-size: 14px;
}

/* ุฅุถุงูุฉ ุนูุงูุฉ ุตุญ ูุจู ุงูุฑุณุงูุฉ */
.success-message::before {
  content: "โ ";
}

/* ======================== ุงูุฌุฏูู ======================== */
.table-wrapper {
  width: 100%; /* ุงูุนุฑุถ ูุงูู ุงูุญุงููุฉ */
  overflow-x: auto; /* ุดุฑูุท ุชูุฑูุฑ ุฃููู ุฅุฐุง ุงูุถุบุท ุงูุฌุฏูู */
  margin-top: 20px;
}

table {
  width: 100%; /* ุงูุนุฑุถ ูุงูู */
  min-width: 400px; /* ุงูุญุฏ ุงูุฃุฏูู ููุนุฑุถ */
  border-collapse: collapse; /* ุฏูุฌ ุงูุญุฏูุฏ */
  text-align: center; /* ูุญุงุฐุงุฉ ุงููุต ูู ุงููุณุท */
  font-size: 13px; /* ุญุฌู ุงูุฎุท */
}

th, td {
  border: 1px solid #03a9f4; /* ุญุฏูุฏ ุฒุฑูุงุก ููุฎูุงูุง */
  padding: 8px; /* ูุณุงูุฉ ุฏุงุฎููุฉ ููุฎูุงูุง */
}

th {
  background-color: #03a9f4; /* ุฎูููุฉ ุงูุนููุงู ุฃุฒุฑู */
  color: white; /* ูุต ุฃุจูุถ */
}

/* ุชูููู ุงูุตููู ุงูุฒูุฌูุฉ */
tr:nth-child(even) td {
  background-color: #e1f5fe;
}

/* ======================== ุงุณุชุฌุงุจุฉ ููุดุงุดุงุช ุงูุตุบูุฑุฉ ======================== */
@media (max-width: 600px) {
  body { padding: 10px; }
  h1 { font-size: 20px; }
  .container { padding: 15px; }
  button { font-size: 14px; }
  table { font-size: 12px; }
}
</style>
</head>

<body>

<h1>ุญุงุณุจุฉ ุงูุงุณุชุฑุฏุงุฏ ุงููููู</h1>

<div class="container">
  <!-- ุฑุณุงูุฉ ูุฌุงุญ ุนูุฏ ุญูุธ ุงูุนููู -->
  <div class="success-message" id="successMsg">ุชู ุญูุธ ุงูุนููู ุจูุฌุงุญ</div>

  <!-- ======================== ุญููู ุงูุฅุฏุฎุงู ======================== -->
  <label>ุงุณู ุงูุนููู</label>
  <input type="text" id="clientName" placeholder="ุงุฏุฎู ุงุณู ุงูุนููู">

  <label>ุฑูู ุงูุนููู</label>
  <input type="text" id="clientNumber" placeholder="ุงุฏุฎู ุฑูู ุงูุนููู">

  <label>ูููุฉ ุงูุจุงูุฉ</label>
  <input type="number" id="packageValue" placeholder="ุงุฏุฎู ูููุฉ ุงูุจุงูุฉ">

  <label>ุนุฏุฏ ุฃูุงู ุงูุจุงูุฉ ุงูุฃุณุงุณูุฉ</label>
  <input type="number" id="packageDays" placeholder="ุงุฏุฎู ุนุฏุฏ ุงูุฃูุงู">

  <label>ุนุฏุฏ ุงูุฃูุงู ุงููุณุชูุงุฏ ุจูุง</label>
  <input type="number" id="daysUsed" placeholder="ุงุฏุฎู ุงูุฃูุงู ุงููุณุชูุงุฏ ุจูุง">

  <label>ุงุณู ุงูุจูู</label>
  <input type="text" id="bankName" placeholder="ุงุฏุฎู ุงุณู ุงูุจูู">

  <label>ุฑูู ุงูุญุณุงุจ ุงูุจููู</label>
  <input type="text" id="bankAccount" placeholder="ุงุฏุฎู ุฑูู ุงูุญุณุงุจ">

  <label>ููุน ุงูุงุดุชุฑุงู</label>
  <select id="subscriptionType">
    <option value="ุฌุฏูุฏ ุชุทุจูู">ุฌุฏูุฏ ุชุทุจูู</option>
    <option value="ุชุฌุฏูุฏ ุชุทุจูู">ุชุฌุฏูุฏ ุชุทุจูู</option>
    <option value="ุฌุฏูุฏ ูุฏูู">ุฌุฏูุฏ ูุฏูู</option>
    <option value="ุชุฌุฏูุฏ ูุฏูู">ุชุฌุฏูุฏ ูุฏูู</option>
  </select>

  <label>ุงูููุงุญุธุงุช</label>
  <input type="text" id="notes" placeholder="ุงุฏุฎู ููุงุญุธุงุช">

  <!-- ======================== ุงูุฃุฒุฑุงุฑ ======================== -->
  <button onclick="addClient()">๐พ ุญูุธ ุงูุนููู</button>
  <button class="calculate" onclick="calculateRefund()">๐ฐ ุงุญุณุจ ุงูุงุณุชุฑุฏุงุฏ</button>
</div>

<!-- ======================== ุฌุฏูู ุงูุนููุงุก ======================== -->
<div class="table-wrapper">
  <table id="clientsTable">
    <tr>
      <th>ุงุณู ุงูุนููู</th>
      <th>ูููุฉ ุงูุจุงูุฉ (ุนุฏุฏ ุงูุฃูุงู)</th>
      <th>ุงููุจูุบ ุงููุณุชุฑุฏ</th>
      <th>ุญุฐู</th>
    </tr>
  </table>
</div>

<!-- ุฒุฑ ุชุตุฏูุฑ ุฅูู Excel -->
<button onclick="exportToExcel()">๐ฅ ุฅุตุฏุงุฑ ููู Excel</button>

<script>
// ======================= ูุตูููุฉ ูุชุฎุฒูู ุจูุงูุงุช ุงูุนููุงุก =======================
let clients = []; // ูู ุนูุตุฑ ูููุง ููุซู ุนููู ูุงุญุฏ ููุฌููุนุฉ ุฎุตุงุฆุต (object)

// ======================= ุฏุงูุฉ ุญูุธ ุงูุนููู =======================
function addClient() {
  // ูุฑุงุกุฉ ุงูููู ูู ุงูุญููู
  const name = document.getElementById('clientName').value.trim(); // trim ูุงุฒุงูุฉ ุงููุฑุงุบุงุช
  const number = document.getElementById('clientNumber').value.trim();
  const packageValue = parseFloat(document.getElementById('packageValue').value); // ุชุญููู ุงููุต ูุฑูู
  const packageDays = parseFloat(document.getElementById('packageDays').value);
  const daysUsed = parseFloat(document.getElementById('daysUsed').value);
  const bank = document.getElementById('bankName').value.trim();
  const account = document.getElementById('bankAccount').value.trim();
  const type = document.getElementById('subscriptionType').value;
  const notes = document.getElementById('notes').value.trim();

  // ุงูุชุญูู ูู ุตุญุฉ ุงูุจูุงูุงุช
  if (!name || !number) {
    alert("ุงูุฑุฌุงุก ุฅุฏุฎุงู ุงุณู ูุฑูู ุงูุนููู");
    return; // ุชููู ุงูุฏุงูุฉ ุฅุฐุง ุงูุจูุงูุงุช ูุงูุตุฉ
  }
  if (daysUsed > packageDays) {
    alert("ุนุฏุฏ ุงูุฃูุงู ุงููุณุชูุงุฏ ุจูุง ูุง ูููู ุฃู ูุชุฌุงูุฒ ุนุฏุฏ ุงูุฃูุงู ุงูููู ููุจุงูุฉ");
    return;
  }

  // ุฅุถุงูุฉ ุงูุนููู ูููุตูููุฉ
  clients.push({ 
    name, number, packageValue, packageDays, daysUsed, bank, account, type, notes, refund: '' 
  });

  // ุนุฑุถ ุฑุณุงูุฉ ูุฌุงุญ ูุคูุชุฉ
  document.getElementById('successMsg').style.display = 'block';
  setTimeout(() => document.getElementById('successMsg').style.display = 'none', 2000);

  renderTable(); // ุชุญุฏูุซ ุงูุฌุฏูู
  clearInputs(); // ูุณุญ ุงูุญููู ุจุนุฏ ุงูุญูุธ
}

// ======================= ุฏุงูุฉ ูุณุญ ุงูุญููู ุจุนุฏ ุงูุญูุธ =======================
function clearInputs() {
  document.querySelectorAll('input').forEach(i => i.value = ''); // ูู ุงูุญููู ูุตูุฉ ูุชู ูุณุญูุง
}

// ======================= ุญุณุงุจ ุงููุจูุบ ุงููุณุชุฑุฏ =======================
function calculateRefund() {
  clients.forEach(c => {
    // ูููุฉ ุงูููู ุงููุงุญุฏ * ุนุฏุฏ ุงูุฃูุงู ุงููุชุจููุฉ = ุงููุจูุบ ุงููุณุชุฑุฏ
    c.refund = ((c.packageValue / c.packageDays) * (c.packageDays - c.daysUsed)).toFixed(2);
  });
  renderTable(); // ุชุญุฏูุซ ุงูุฌุฏูู
}

// ======================= ุนุฑุถ ุงูุฌุฏูู =======================
function renderTable() {
  const table = document.getElementById("clientsTable");
  // ุฅุนุงุฏุฉ ุจูุงุก ุงูุฌุฏูู
  table.innerHTML = `
    <tr>
      <th>ุงุณู ุงูุนููู</th>
      <th>ูููุฉ ุงูุจุงูุฉ (ุนุฏุฏ ุงูุฃูุงู)</th>
      <th>ุงููุจูุบ ุงููุณุชุฑุฏ</th>
      <th>ุญุฐู</th>
    </tr>
  `;
  // ุฅุถุงูุฉ ุตู ููู ุนููู
  clients.forEach((c, index) => {
    table.innerHTML += `
      <tr>
        <td>${c.name}</td>
        <td>${c.packageValue} (${c.packageDays})</td>
        <td>${c.refund || "-"}</td>
        <td><button class="delete" onclick="deleteClient(${index})">๐๏ธ</button></td>
      </tr>
    `;
  });
}

// ======================= ุญุฐู ุนููู =======================
function deleteClient(index) {
  if (confirm("ูู ุฃูุช ูุชุฃูุฏ ูู ุญุฐู ูุฐุง ุงูุนูููุ")) {
    clients.splice(index, 1); // ุฅุฒุงูุฉ ุงูุนููู ูู ุงููุตูููุฉ
    renderTable(); // ุชุญุฏูุซ ุงูุฌุฏูู
  }
}

// ======================= ุชุตุฏูุฑ ุฅูู Excel =======================
function exportToExcel() {
  // ุฅูุดุงุก ุฌุฏูู HTML ููุต
  let html = `<table border='1' style='border-collapse:collapse; font-family:Tahoma; font-size:14px;'>`;
  html += `<tr>
    <th>ุงุณู ุงูุนููู</th>
    <th>ุฑูู ุงูุนููู</th>
    <th>ูููุฉ ุงูุจุงูุฉ (ุนุฏุฏ ุงูุฃูุงู)</th>
    <th>ุนุฏุฏ ุงูุฃูุงู ุงููุณุชูุงุฏ ุจูุง</th>
    <th>ุงุณู ุงูุจูู</th>
    <th>ุฑูู ุงูุญุณุงุจ ุงูุจููู</th>
    <th>ููุน ุงูุงุดุชุฑุงู</th>
    <th>ุงููุจูุบ ุงููุณุชุฑุฏ</th>
    <th>ุงูููุงุญุธุงุช</th>
  </tr>`;
  clients.forEach(c => {
    html += `<tr>
      <td>${c.name}</td>
      <td>${c.number}</td>
      <td>${c.packageValue} (${c.packageDays})</td>
      <td>${c.daysUsed}</td>
      <td>${c.bank}</td>
      <td>${c.account}</td>
      <td>${c.type}</td>
      <td>${c.refund}</td>
      <td>${c.notes}</td>
    </tr>`;
  });
  html += "</table>";

  const blob = new Blob([html], { type: "application/vnd.ms-excel" }); // ุชุญููู ุงููุต ูููู Excel
  const url = URL.createObjectURL(blob);
  const link = document.createElement("a");

  // ุฅุถุงูุฉ ุชุงุฑูุฎ ุงูููู ููููู
  const today = new Date();
  const dateStr = today.toLocaleDateString('ar-EG', { day: '2-digit', month: 'long', year:'numeric' });

  link.href = url;
  link.download = `ุงูุงุณุชุฑุฏุงุฏ ุงููููู ${dateStr}.xls`;
  link.click(); // ุชูุฒูู ุงูููู
}
</script>

</body>
</html>
