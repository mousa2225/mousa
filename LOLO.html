<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø§Ø³ØªØ±Ø¯Ø§Ø¯ Ø§Ù„ÙŠÙˆÙ…ÙŠ</title>
<style>
  body {
    font-family: "Tahoma", Arial, sans-serif;
    background: #e0f7fa; /* Ø³Ù…Ø§ÙˆÙŠ ÙØ§ØªØ­ */
    padding: 20px;
    margin: 0;
  }

  h1 {
    color: #0288d1; /* Ø³Ù…Ø§ÙˆÙŠ ØºØ§Ù…Ù‚ */
    text-align: center;
    margin-bottom: 25px;
  }

  .form-container {
    background: #ffffff; /* Ø£Ø¨ÙŠØ¶ */
    border-radius: 16px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    max-width: 500px;
    margin: 0 auto 30px;
    padding: 25px;
    display: flex;
    flex-direction: column;
    gap: 15px;
  }

  label {
    font-weight: bold;
    color: #444;
    display: block;
    margin-bottom: 5px;
  }

  input, select {
    width: 100%;
    padding: 10px;
    border: 2px solid #4fc3f7; /* Ø³Ù…Ø§ÙˆÙŠ ÙØ§ØªØ­ */
    border-radius: 8px;
    font-size: 15px;
    text-align: center;
    transition: 0.3s;
  }

  input:focus, select:focus {
    background-color: #b3e5fc;
    border-color: #0288d1;
    outline: none;
  }

  button {
    background-color: #0288d1; /* Ø³Ù…Ø§ÙˆÙŠ ØºØ§Ù…Ù‚ */
    color: white;
    border: none;
    padding: 10px 16px;
    border-radius: 8px;
    cursor: pointer;
    font-size: 15px;
    transition: 0.3s;
  }

  button:hover {
    background-color: #0277bd;
  }

  button.calculate {
    background-color: #4fc3f7; /* Ø³Ù…Ø§ÙˆÙŠ ÙØ§ØªØ­ */
    font-size: 13px;
    padding: 7px 10px;
    border-radius: 8px;
    margin-top: 10px;
  }

  button.calculate:hover {
    background-color: #03a9f4;
  }

  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 25px;
    border: 2px solid #4fc3f7;
    background-color: white;
    border-radius: 10px;
    overflow: hidden;
    table-layout: fixed;
    word-wrap: break-word;
  }

  th, td {
    border: 1px solid #b3e5fc;
    padding: 12px;
    text-align: center;
    font-size: 15px;
  }

  th {
    background-color: #0288d1;
    color: white;
  }

  tr:nth-child(even) td {
    background-color: #e1f5fe;
  }

  .success-message {
    color: #0277bd;
    font-weight: bold;
    margin-bottom: 10px;
    display: none;
    text-align: center;
    font-size: 16px;
  }

  .success-message::before {
    content: "âœ” ";
  }

  @media screen and (max-width: 600px) {
    .form-container {
      padding: 15px;
    }
    input, select, button {
      font-size: 14px;
    }
    th, td {
      font-size: 13px;
      padding: 8px;
    }
  }
</style>
</head>
<body>

<h1>Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø§Ø³ØªØ±Ø¯Ø§Ø¯ Ø§Ù„ÙŠÙˆÙ…ÙŠ</h1>

<div class="form-container">
  <div class="success-message" id="successMsg">ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­</div>

  <label>Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„</label>
  <input type="text" id="clientName" placeholder="Ø§Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„">

  <label>Ø±Ù‚Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„</label>
  <input type="text" id="clientNumber" placeholder="Ø§Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„">

  <label>Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¨Ø§Ù‚Ø©</label>
  <input type="number" id="packageValue" placeholder="Ø§Ø¯Ø®Ù„ Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¨Ø§Ù‚Ø©">

  <label>Ø¹Ø¯Ø¯ Ø£ÙŠØ§Ù… Ø§Ù„Ø¨Ø§Ù‚Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©</label>
  <input type="number" id="packageDays" placeholder="Ø§Ø¯Ø®Ù„ Ø¹Ø¯Ø¯ Ø£ÙŠØ§Ù… Ø§Ù„Ø¨Ø§Ù‚Ø©">

  <label>Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ù…Ø³ØªÙØ§Ø¯ Ø¨Ù‡Ø§</label>
  <input type="number" id="daysUsed" placeholder="Ø§Ø¯Ø®Ù„ Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ù…Ø³ØªÙØ§Ø¯ Ø¨Ù‡Ø§">

  <label>Ø§Ø³Ù… Ø§Ù„Ø¨Ù†Ùƒ</label>
  <input type="text" id="bankName" placeholder="Ø§Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ø¨Ù†Ùƒ">

  <label>Ø±Ù‚Ù… Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¨Ù†ÙƒÙŠ</label>
  <input type="text" id="bankAccount" placeholder="Ø§Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ø­Ø³Ø§Ø¨">

  <label>Ù†ÙˆØ¹ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ</label>
  <select id="subscriptionType">
    <option value="Ø¬Ø¯ÙŠØ¯ ØªØ·Ø¨ÙŠÙ‚">Ø¬Ø¯ÙŠØ¯ ØªØ·Ø¨ÙŠÙ‚</option>
    <option value="ØªØ¬Ø¯ÙŠØ¯ ØªØ·Ø¨ÙŠÙ‚">ØªØ¬Ø¯ÙŠØ¯ ØªØ·Ø¨ÙŠÙ‚</option>
    <option value="Ø¬Ø¯ÙŠØ¯ ÙŠØ¯ÙˆÙŠ">Ø¬Ø¯ÙŠØ¯ ÙŠØ¯ÙˆÙŠ</option>
    <option value="ØªØ¬Ø¯ÙŠØ¯ ÙŠØ¯ÙˆÙŠ">ØªØ¬Ø¯ÙŠØ¯ ÙŠØ¯ÙˆÙŠ</option>
  </select>

  <label>Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª</label>
  <input type="text" id="notes" placeholder="Ø§Ø¯Ø®Ù„ Ù…Ù„Ø§Ø­Ø¸Ø§Øª">

  <button onclick="addClient()">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ø¹Ù…ÙŠÙ„</button>
  <button class="calculate" onclick="calculateRefund()">Ø§Ø­Ø³Ø¨ Ø§Ù„Ø§Ø³ØªØ±Ø¯Ø§Ø¯</button>
</div>

<table id="clientsTable">
  <tr>
    <th>Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„</th>
    <th>Ø±Ù‚Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„</th>
    <th>Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¨Ø§Ù‚Ø©(Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙŠØ§Ù…)</th>
    <th>Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ù…Ø³ØªÙØ§Ø¯ Ø¨Ù‡Ø§</th>
    <th>Ø§Ø³Ù… Ø§Ù„Ø¨Ù†Ùƒ</th>
    <th>Ø±Ù‚Ù… Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¨Ù†ÙƒÙŠ</th>
    <th>Ù†ÙˆØ¹ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ</th>
    <th>Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø³ØªØ±Ø¯</th>
    <th>Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª</th>
  </tr>
</table>

<button onclick="exportToExcel()">ğŸ“¥ Ø¥ØµØ¯Ø§Ø± Ù…Ù„Ù Excel</button>

<script>
let clients = [];

function addClient() {
  const name = document.getElementById('clientName').value.trim();
  const number = document.getElementById('clientNumber').value.trim();
  const packageValue = document.getElementById('packageValue').value.trim();
  const packageDays = document.getElementById('packageDays').value.trim();
  const daysUsed = document.getElementById('daysUsed').value.trim();
  const bank = document.getElementById('bankName').value.trim();
  const account = document.getElementById('bankAccount').value.trim();
  const type = document.getElementById('subscriptionType').value;
  const notes = document.getElementById('notes').value.trim();

  if(!name || !number) return alert("Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ù„Ù„Ø¹Ù…ÙŠÙ„");
  if(daysUsed > packageDays) {
    alert("Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ù…Ø³ØªÙØ§Ø¯ Ø¨Ù‡Ø§ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø£Ù† ÙŠØªØ¬Ø§ÙˆØ² Ø£ÙŠØ§Ù… Ø§Ù„Ø¨Ø§Ù‚Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©");
    return;
  }

  clients.push({
    name, number, packageValue, packageDays, daysUsed, bank, account, type, refund: '', notes
  });

  document.getElementById('successMsg').style.display = 'block';
  setTimeout(()=>document.getElementById('successMsg').style.display='none',2000);

  renderTable();
}

function calculateRefund() {
  clients.forEach(c => {
    if(c.refund === '') {
      c.refund = ((c.packageValue / c.packageDays) * c.daysUsed).toFixed(2);
    }
  });
  renderTable();
}

function renderTable() {
  const table = document.getElementById("clientsTable");
  table.innerHTML = `
    <tr>
      <th>Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„</th>
      <th>Ø±Ù‚Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„</th>
      <th>Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¨Ø§Ù‚Ø©(Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙŠØ§Ù…)</th>
      <th>Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ù…Ø³ØªÙØ§Ø¯ Ø¨Ù‡Ø§</th>
      <th>Ø§Ø³Ù… Ø§Ù„Ø¨Ù†Ùƒ</th>
      <th>Ø±Ù‚Ù… Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¨Ù†ÙƒÙŠ</th>
      <th>Ù†ÙˆØ¹ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ</th>
      <th>Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø³ØªØ±Ø¯</th>
      <th>Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª</th>
    </tr>
  `;

  clients.forEach(c => {
    table.innerHTML += `<tr>
      <td>${c.name}</td>
      <td>${c.number}</td>
      <td>${c.packageValue}(${c.packageDays})</td>
      <td>${c.daysUsed}</td>
      <td>${c.bank}</td>
      <td>${c.account}</td>
      <td>${c.type}</td>
      <td>${c.refund}</td>
      <td>${c.notes}</td>
    </tr>`;
  });
}

function exportToExcel() {
  let html = `
    <table border='1' style='border-collapse:collapse; font-family:Tahoma; font-size:14px;'>
      <tr>
        <th>Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„</th>
        <th>Ø±Ù‚Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„</th>
        <th>Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¨Ø§Ù‚Ø©(Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙŠØ§Ù…)</th>
        <th>Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ù…Ø³ØªÙØ§Ø¯ Ø¨Ù‡Ø§</th>
        <th>Ø§Ø³Ù… Ø§Ù„Ø¨Ù†Ùƒ</th>
        <th>Ø±Ù‚Ù… Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¨Ù†ÙƒÙŠ</th>
        <th>Ù†ÙˆØ¹ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ</th>
        <th>Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø³ØªØ±Ø¯</th>
        <th>Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª</th>
      </tr>
  `;

  clients.forEach(c => {
    html += "<tr>";
    html += `<td>${c.name}</td>`;
    html += `<td>${c.number}</td>`;
    html += `<td>${c.packageValue}(${c.packageDays})</td>`;
    html += `<td>${c.daysUsed}</td>`;
    html += `<td>${c.bank}</td>`;
    html += `<td>${c.account}</td>`;
    html += `<td>${c.type}</td>`;
    html += `<td>${c.refund}</td>`;
    html += `<td>${c.notes}</td>`;
    html += "</tr>";
  });

  html += "</table>";

  const blob = new Blob([html], { type: "application/vnd.ms-excel" });
  const url = URL.createObjectURL(blob);
  const link = document.createElement("a");
  const today = new Date();
  const yesterday = new Date(today);
  yesterday.setDate(today.getDate() - 1);
  const dateStr = yesterday.toLocaleDateString('en-GB', { day: '2-digit', month: 'long', year:'numeric' });
  link.href = url;
  link.download = `Ø§Ù„Ø§Ø³ØªØ±Ø¯Ø§Ø¯ Ø§Ù„ÙŠÙˆÙ…ÙŠ ${dateStr}.xls`;
  link.click();
}
</script>

</body>
</html>
