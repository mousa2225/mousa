<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>حاسبة تحويل الباقات خطوة خطوة</title>
<link href="https://fonts.googleapis.com/css2?family=Rakkas&display=swap" rel="stylesheet">
<style>
body { font-family: Arial, sans-serif; padding: 30px; background: #e0f7fa; }
.container { max-width: 600px; margin:auto; background:#fff; padding:20px; border-radius:12px; box-shadow:0 6px 20px rgba(0,0,0,0.15);}
h2 { text-align:center; color:#00796b; }
input[type=number] { width:100%; padding:10px; margin-top:10px; border-radius:8px; border:1px solid #b0bec5; font-size:16px;}
button { margin-top:15px; width:100%; padding:12px; border:none; border-radius:10px; background:#0288d1; color:white; font-size:16px; cursor:pointer; transition:0.3s;}
button:hover { background:#026aa7; }
#nextBtn { background:#0288d1; }
#printBtn { display:none; margin-top:10px; background:#009688; font-size:18px; padding:12px; border-radius:10px;}
#printBtn:hover { background:#00796b; }
.results { margin-top:20px; padding:15px; border-radius:10px; border:1px solid #c5e1a5; background:white; box-shadow:0 3px 10px rgba(0,0,0,0.1);}
table { width:100%; border-collapse:collapse; margin-top:10px; background:white; }
th, td { border:1px solid #b0bec5; padding:10px; text-align:center; font-size:16px; }
th { background:#0288d1; color:white; }
.printLogo { text-align:center; margin-bottom:15px; }
.printLogo img { max-width:150px; }
.signature { margin-top:20px; text-align:left; font-family:'Rakkas', 'Arial', cursive; font-size:20px; color:#00796b; }
.signature .line { border-bottom:2px solid #00796b; display:block; width:300px; height:20px; margin-bottom:6px; }

/* إعدادات الطباعة */
@media print {
  body * { visibility: hidden; }
  .results, .results * { visibility: visible; }
  .results { position: absolute; top: 20px; left: 20px; width: calc(100% - 40px); background:white; padding:30px; border-radius:16px; box-shadow:0 0 20px rgba(0,0,0,0.2); border:2px solid #0288d1; }
  .printLogo { display:block; }
  .signature { display:block; }
  button { display:none; }
}
</style>
</head>
<body>
<div class="container">
  <h2>حاسبة تحويل الباقات خطوة خطوة</h2>
  <div id="stepContainer">
    <label id="questionLabel">سعر الباقة السابقة:</label>
    <input type="number" id="answerInput" min="0">
    <button id="nextBtn" onclick="nextStep()">التالي</button>
  </div>

  <div class="results" id="results" style="display:none;"></div>
  <button id="printBtn" onclick="window.print()">🖨️ طباعة الملخص</button>
</div>

<script>
const questions = [
  {label: "سعر الباقة السابقة:", id:"oldPrice"},
  {label: "عدد أيام الباقة السابقة:", id:"oldDays"},
  {label: "سعر الباقة الجديدة:", id:"newPrice"},
  {label: "عدد أيام الباقة الجديدة:", id:"newDays"},
  {label: "الأيام المستخدمة من الباقة السابقة:", id:"usedOld"},
  {label: "الأيام التي بايستخدمها من الباقة الجديدة:", id:"usedNew"}
];

const answers = {};
let currentStep = 0;

function nextStep() {
  const value = parseFloat(document.getElementById("answerInput").value);
  if(isNaN(value) || value < 0) {
    alert("يرجى إدخال قيمة صحيحة");
    return;
  }

  answers[questions[currentStep].id] = value;
  currentStep++;

  if(currentStep < questions.length){
    document.getElementById("questionLabel").innerText = questions[currentStep].label;
    document.getElementById("answerInput").value = "";
    document.getElementById("answerInput").focus();
  } else {
    showResults();
  }
}

function showResults(){
  const oldRate = answers.oldPrice / answers.oldDays;
  const newRate = answers.newPrice / answers.newDays;
  const costOld = oldRate * answers.usedOld;
  const costNew = newRate * answers.usedNew;
  const total = costOld + costNew;
  const paid = answers.oldPrice;
  const remaining = paid - total;
  const remainingText = remaining >= 0 ? "المتبقي للعميل" : "المتبقي على العميل";
  const remainColor = remaining >= 0 ? "#388e3c" : "#d32f2f";

  let html = `
    <div class="printLogo">
      <img src="https://i.postimg.cc/0rR6MfD3/image.png" alt="شعار الشركة">
    </div>
    <h3 style="text-align:center; color:#00796b;">ملخص تحويل الباقات</h3>
    <table>
      <tr><th>الوصف</th><th>القيمة (ريال)</th></tr>
      <tr><td>سعر اليوم في الباقة السابقة</td><td>${oldRate.toFixed(2)}</td></tr>
      <tr><td>سعر اليوم في الباقة الجديدة</td><td>${newRate.toFixed(2)}</td></tr>
      <tr><td>المستحق من الباقة السابقة</td><td>${costOld.toFixed(2)}</td></tr>
      <tr><td>المستحق من الباقة الجديدة</td><td>${costNew.toFixed(2)}</td></tr>
      <tr><td>إجمالي المستحق</td><td>${total.toFixed(2)}</td></tr>
      <tr><td>المبلغ المدفوع</td><td>${paid.toFixed(2)}</td></tr>
      <tr><td>${remainingText}</td><td style="color:${remainColor}; font-weight:bold;">${Math.abs(remaining).toFixed(2)}</td></tr>
    </table>
    <div class="signature"><span class="line"></span>Accountant Mousa</div>
  `;

  document.getElementById("stepContainer").style.display = "none";
  const resDiv = document.getElementById("results");
  resDiv.style.display = "block";
  resDiv.innerHTML = html;
  document.getElementById("printBtn").style.display = "block";
}
</script>
</body>
</html>
