<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>مصمم تخطيط عمراني لصالة مبنى ضخم</title>

    <!-- مكتبات Three.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://threejs.org/examples/js/loaders/FontLoader.js"></script>
    <script src="https://threejs.org/examples/js/geometries/TextGeometry.js"></script>

    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            padding: 20px;
            direction: rtl;
            text-align: center;
        }
        form {
            max-width: 600px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        label { display: block; margin-bottom: 10px; text-align: right; }
        input {
            width: 100%;
            padding: 8px;
            margin-bottom: 20px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        button {
            background-color: #4CAF50;
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        button:hover { background-color: #45a049; }
        #scene-container { width: 100%; height: 600px; margin-top: 20px; }
        #measurements {
            margin-top: 20px;
            padding: 10px;
            background: #fff;
            border: 1px solid #ddd;
            border-radius: 4px;
            text-align: right;
        }
    </style>
</head>
<body>
    <h1>حاسبة ومصمم تخطيط عمراني لصالة مبنى ضخم</h1>

    <form id="input-form">
        <label for="land-length">طول الأرض (بالمتر):</label>
        <input type="number" id="land-length" required min="10" step="0.1">

        <label for="land-width">عرض الأرض (بالمتر):</label>
        <input type="number" id="land-width" required min="10" step="0.1">

        <label for="num-rooms">عدد الغرف (اختياري):</label>
        <input type="number" id="num-rooms" min="0" step="1">

        <label for="num-bathrooms">عدد الحمامات (اختياري):</label>
        <input type="number" id="num-bathrooms" min="0" step="1">

        <button type="submit">إنشاء المخطط</button>
    </form>

    <div id="scene-container"></div>
    <div id="measurements"></div>

    <script>
        const form = document.getElementById('input-form');
        const sceneContainer = document.getElementById('scene-container');
        const measurementsDiv = document.getElementById('measurements');

        let scene, camera, renderer;

        form.addEventListener('submit', function(event) {
            event.preventDefault();

            const landLength = parseFloat(document.getElementById('land-length').value);
            const landWidth = parseFloat(document.getElementById('land-width').value);
            const numRooms = parseInt(document.getElementById('num-rooms').value) || 0;
            const numBathrooms = parseInt(document.getElementById('num-bathrooms').value) || 0;

            // حسابات بسيطة
            const totalArea = landLength * landWidth;
            const hallArea = totalArea * 0.6;
            const hallLength = landLength * 0.8;
            const hallWidth = hallArea / hallLength;

            const roomSize = 4; // م
            const bathroomSize = 2; // م
            const wallThickness = 0.2; // م
            const doorWidth = 1; // م

            const roomsPerSide = Math.ceil(numRooms / 2);
            const bathroomsPerSide = Math.ceil(numBathrooms / 2);

            init3D(landLength, landWidth);
            drawBuilding(landLength, landWidth, hallLength, hallWidth, numRooms, numBathrooms,
                roomSize, bathroomSize, wallThickness, doorWidth, roomsPerSide, bathroomsPerSide);
            displayMeasurements(landLength, landWidth, hallLength, hallWidth,
                numRooms, numBathrooms, roomSize, bathroomSize, wallThickness, doorWidth);

            animate();
        });

        function init3D(landLength, landWidth) {
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0xcccccc);

            camera = new THREE.PerspectiveCamera(75, sceneContainer.clientWidth / 600, 0.1, 1000);
            camera.position.set(landLength / 2, 30, landWidth + 20);

            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(sceneContainer.clientWidth, 600);
            sceneContainer.innerHTML = '';
            sceneContainer.appendChild(renderer.domElement);

            const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
            scene.add(ambientLight);
            const directionalLight = new THREE.DirectionalLight(0xffffff, 0.6);
            directionalLight.position.set(landLength, landWidth, landLength);
            scene.add(directionalLight);

            const floorGeometry = new THREE.PlaneGeometry(landLength, landWidth);
            const floorMaterial = new THREE.MeshBasicMaterial({ color: 0xaaaaaa, side: THREE.DoubleSide });
            const floor = new THREE.Mesh(floorGeometry, floorMaterial);
            floor.rotation.x = -Math.PI / 2;
            scene.add(floor);
        }

        function drawBuilding(landLength, landWidth, hallLength, hallWidth, numRooms, numBathrooms,
                              roomSize, bathroomSize, wallThickness, doorWidth, roomsPerSide, bathroomsPerSide) {

            // الصالة
            const hallGeometry = new THREE.BoxGeometry(hallLength, 5, hallWidth);
            const hallMaterial = new THREE.MeshBasicMaterial({ color: 0x00ff00, wireframe: true });
            const hall = new THREE.Mesh(hallGeometry, hallMaterial);
            hall.position.set(hallLength / 2, 2.5, hallWidth / 2 + (landWidth - hallWidth) / 2);
            scene.add(hall);
            addText(`الصالة: ${hallLength.toFixed(1)}m x ${hallWidth.toFixed(1)}m`, hall.position.x, 6, hall.position.z);

            // الغرف
            const roomOffset = hallWidth / 2 + (landWidth - hallWidth) / 2 + roomSize / 2 + wallThickness;
            for (let i = 0; i < numRooms; i++) {
                const roomGeometry = new THREE.BoxGeometry(roomSize, 5, roomSize);
                const roomMaterial = new THREE.MeshBasicMaterial({ color: 0x0000ff, wireframe: true });
                const room = new THREE.Mesh(roomGeometry, roomMaterial);
                room.position.set((i % roomsPerSide) * (roomSize + wallThickness) + roomSize / 2,
                                  2.5, i < roomsPerSide ? roomOffset : landWidth - roomOffset);
                scene.add(room);
                addDoor(room.position.x, room.position.z, doorWidth);
                addText(`غرفة ${i + 1}: ${roomSize}m x ${roomSize}m`, room.position.x, 6, room.position.z);
            }

            // الحمامات
            const bathOffset = roomOffset + (numRooms > 0 ? roomSize + wallThickness : 0);
            for (let i = 0; i < numBathrooms; i++) {
                const bathGeometry = new THREE.BoxGeometry(bathroomSize, 5, bathroomSize);
                const bathMaterial = new THREE.MeshBasicMaterial({ color: 0xff0000, wireframe: true });
                const bath = new THREE.Mesh(bathGeometry, bathMaterial);
                bath.position.set((i % bathroomsPerSide) * (bathroomSize + wallThickness) + bathroomSize / 2,
                                  2.5, i < bathroomsPerSide ? bathOffset : landWidth - bathOffset);
                scene.add(bath);
                addText(`حمام ${i + 1}: ${bathroomSize}m x ${bathroomSize}m`, bath.position.x, 6, bath.position.z);
            }

            // الجدران الخارجية
            const outerWallGeometry = new THREE.BoxGeometry(landLength, 5, landWidth);
            const outerWallMaterial = new THREE.MeshBasicMaterial({ color: 0x000000, wireframe: true });
            const outerWall = new THREE.Mesh(outerWallGeometry, outerWallMaterial);
            outerWall.position.set(landLength / 2, 2.5, landWidth / 2);
            scene.add(outerWall);
        }

        function addDoor(x, z, doorWidth) {
            const doorMaterial = new THREE.LineBasicMaterial({ color: 0xffff00 });
            const doorPoints = [
                new THREE.Vector3(x - doorWidth / 2, 0, z),
                new THREE.Vector3(x + doorWidth / 2, 0, z)
            ];
            const doorGeometry = new THREE.BufferGeometry().setFromPoints(doorPoints);
            const door = new THREE.Line(doorGeometry, doorMaterial);
            scene.add(door);
        }

        function addText(text, x, y, z) {
            const loader = new THREE.FontLoader();
            loader.load('https://threejs.org/examples/fonts/helvetiker_regular.typeface.json', function(font) {
                const textGeometry = new THREE.TextGeometry(text, {
                    font: font,
                    size: 0.5,
                    height: 0.05
                });
                const textMaterial = new THREE.MeshBasicMaterial({ color: 0x000000 });
                const textMesh = new THREE.Mesh(textGeometry, textMaterial);
                textMesh.position.set(x - text.length / 4, y, z);
                scene.add(textMesh);
            });
        }

        function displayMeasurements(landLength, landWidth, hallLength, hallWidth,
                                     numRooms, numBathrooms, roomSize, bathroomSize, wallThickness, doorWidth) {
            let measurements = `
                <h2>القياسات الدقيقة:</h2>
                <p>مساحة الأرض الكلية: ${landLength} × ${landWidth} = ${(landLength * landWidth).toFixed(2)} م²</p>
                <p>أبعاد الصالة الرئيسية: ${hallLength.toFixed(2)} × ${hallWidth.toFixed(2)} م</p>
                <p>سمك الجدران: ${wallThickness} م</p>
                <p>عرض الأبواب: ${doorWidth} م</p>
            `;
            if (numRooms > 0) measurements += `<p>أبعاد كل غرفة: ${roomSize} م × ${roomSize} م</p>`;
            if (numBathrooms > 0) measurements += `<p>أبعاد كل حمام: ${bathroomSize} م × ${bathroomSize} م</p>`;
            measurementsDiv.innerHTML = measurements;
        }

        function animate() {
            requestAnimationFrame(animate);
            renderer.render(scene, camera);
        }
    </script>
</body>
</html>
