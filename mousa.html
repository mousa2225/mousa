<script>
function calculate() {
  const cName = document.getElementById('clientName').value.trim();
  const cNum = document.getElementById('clientNumber').value.trim();
  const oldPrice = parseFloat(document.getElementById('oldPrice').value);
  const oldDays = parseFloat(document.getElementById('oldDays').value);
  const newPrice = parseFloat(document.getElementById('newPrice').value);
  const newDays = parseFloat(document.getElementById('newDays').value);
  const usedOld = parseFloat(document.getElementById('usedOld').value);
  const usedNew = parseFloat(document.getElementById('usedNew').value);

  if ([oldPrice, oldDays, newPrice, newDays, usedOld, usedNew].some(v=>isNaN(v)||v<0)){
    alert("ูุฑุฌู ุฅุฏุฎุงู ููู ุตุญูุญุฉ.");
    return;
  }

  const oldRate = oldPrice/oldDays;
  const newRate = newPrice/newDays;
  const costOld = oldRate*usedOld;
  const costNew = newRate*usedNew;
  const total = costOld+costNew;
  const paid = oldPrice;
  const remain = paid-total;
  const remainColor = remain<0?"#d32f2f":"#388e3c";
  const remainText = remain<0?"ุงููุชุจูู ุนูู ุงูุนููู":"ุงููุชุจูู ููุนููู";

  let clientHTML = "";
  if(cName || cNum){
    clientHTML = `
    <div class="clientInfoPrint">
      ${cName ? `<h3>ุงุณู ุงูุนููู: ${cName}</h3>` : ""}
      ${cNum ? `<h3>ุฑูู ุงูุนููู: ${cNum}</h3>` : ""}
    </div>`;
  }

  let logoHTML = `
  <div style="text-align:center; margin-bottom:15px;">
    <img src="https://i.postimg.cc/0rR6MfD3/image.png" alt="ุดุนุงุฑ ุงูุดุฑูุฉ" style="max-width:200px;">
  </div>`;

  // โ ุฅุถุงูุฉ ูุนูููุงุช ุงูุจุงูุงุช ููู ุงูุฌุฏูู
  let packageInfoHTML = `
  <div style="
    background:#e0f2f1;
    border:2px solid #0288d1;
    border-radius:12px;
    padding:10px 15px;
    margin:15px 0;
    text-align:center;
    font-weight:bold;
    color:#004d40;
  ">
    <div style="margin:5px 0;">๐ฆ ุงูุจุงูุฉ ุงูุณุงุจูุฉ: <span style="color:#00796b;">${oldPrice.toFixed(2)} ุฑูุงู</span></div>
    <div style="margin:5px 0;">๐ ุงูุจุงูุฉ ุงููุญูู ููุง: <span style="color:#00796b;">${newPrice.toFixed(2)} ุฑูุงู</span></div>
  </div>`;

  document.getElementById('results').innerHTML = `
  ${logoHTML}${clientHTML}
  <h3 style="text-align:center; color:#00796b; margin-top:10px;">ููุฎุต ุชุญููู ุงูุจุงูุงุช</h3>
  ${packageInfoHTML}
  <table>
    <tr>
      <th>ุงููุตู</th>
      <th>ุงูุฃูุงู</th>
      <th>ุงููููุฉ</th>
    </tr>
    <tr><td>ุณุนุฑ ุงูููู ูู ุงูุจุงูุฉ ุงูุณุงุจูุฉ</td><td></td><td>${oldRate.toFixed(2)} ุฑูุงู</td></tr>
    <tr><td>ุณุนุฑ ุงูููู ูู ุงูุจุงูุฉ ุงูุฌุฏูุฏุฉ</td><td></td><td>${newRate.toFixed(2)} ุฑูุงู</td></tr>
    <tr><td>ุงููุณุชุญู ูู ุงูุจุงูุฉ ุงูุณุงุจูุฉ</td><td>${usedOld}</td><td>${costOld.toFixed(2)} ุฑูุงู</td></tr>
    <tr><td>ุงููุณุชุญู ูู ุงูุจุงูุฉ ุงูุฌุฏูุฏุฉ</td><td>${usedNew}</td><td>${costNew.toFixed(2)} ุฑูุงู</td></tr>
    <tr><td>ุฅุฌูุงูู ุงููุณุชุญู</td><td></td><td>${total.toFixed(2)} ุฑูุงู</td></tr>
    <tr><td>ุงููุจูุบ ุงููุฏููุน</td><td></td><td>${paid.toFixed(2)} ุฑูุงู</td></tr>
    <tr><td>${remainText}</td><td></td><td style="color:${remainColor}; font-weight:bold;">${Math.abs(remain).toFixed(2)} ุฑูุงู</td></tr>
  </table>
  <div class="signature"><span class="line"></span>Accountant Mousa</div>`;

  document.getElementById('printBtn').style.display = 'block';
}

function resetFields(){
  ['clientName','clientNumber','oldPrice','oldDays','newPrice','newDays','usedOld','usedNew'].forEach(id=>document.getElementById(id).value='');
  document.getElementById('results').innerHTML='';
  document.getElementById('printBtn').style.display = 'none';
}
</script>
